### 3 items per factor
# true factor loadings
Ptrue3_f <- matrix(c(.7, .8, .9, rep(0,9), .7, .8, .9, rep(0,9), .7, .8, .9), nrow = 9, ncol = 3, byrow = F)
# correlation matrix
corr3_f  <- matrix(c(1, .56, .63, .7*.3*.7, .7*.3*.8, .7*.3*.9, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.7+.7*.3*.5*.9,
                     .56, 1, .72, .8*.3*.7, .8*.3*.8, .8*.3*.9, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.9+.8*.3*.5*.9,
                     .63, .72, 1, .9*.3*.7, .9*.3*.8, .9*.3*.9, -.9*.02*.7+.9*.3*.5*.7, -.9*.02*.8+.9*.3*.5*.8, -.9*.02*.9+.9*.3*.5*.9,
                     .7*.3*.7, .7*.3*.8, .7*.3*.9, 1, .56, .63, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.9-.7*.3*.02*.9,
                     .8*.3*.7, .8*.3*.8, .8*.3*.9, .56, 1, .72, .8*.5*.7-.8*.3*.02*.7, .8*.5*.8-.8*.3*.02*.8, .8*.5*.9-.8*.3*.02*.9,
                     .9*.3*.7, .9*.3*.8, .9*.3*.9, .63, .72, 1, .9*.5*.7-.9*.3*.02*.7, .9*.5*.8-.9*.3*.02*.8, .9*.5*.9-.9*.3*.02*.9,
                     0.0637, -.8*.02*.7+.8*.3*.5*.7, -.9*.02*.7+.9*.3*.5*.7, .7*.5*.7-.7*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .9*.5*.7-.9*.3*.02*.7, 1, .56, .63,
                     -.7*.02*.8+.7*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, -.9*.02*.8+.9*.3*.5*.8, .7*.5*.8-.7*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8, .9*.5*.8-.9*.3*.02*.8, .56, 1, .72,
                     -.7*.02*.7+.7*.3*.5*.9, -.8*.02*.9+.8*.3*.5*.9, -.9*.02*.9+.9*.3*.5*.9, .7*.5*.9-.7*.3*.02*.9, .8*.5*.9-.8*.3*.02*.9, .9*.5*.9-.9*.3*.02*.9, .63, .72, 1
), 9, 9, byrow = T)

### 5 items per factor
# true factor loadings
Ptrue5_f <- matrix(c(.7, .7, .7, .8, .8, rep(0, 15), .7, .7, .7, .8, .8, rep(0, 15), .7, .7, .7, .8, .8), ncol = 3)
# correlation matrix
corr5_f <- matrix(c(1, .49, .49, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8, 
                    .49, 1, .49, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8, 
                    .49, .49, 1, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8,
                    .56, .56, .56, 1, .64, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8,
                    .56, .56, .56, .64, 1, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8,
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, 1, .49, .49, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8,
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .49, 1, .49, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8,
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .49, .49, 1, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8,
                    .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .56, .56, .56, 1, .64, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8,
                    .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .56, .56, .56, .64, 1, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8,
                    0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, 1, .49, .49, .56, .56,
                    0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, .49, 1, .49, .56, .56,
                    0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, .49, .49, 1, .56, .56,
                    0.0728, 0.0728, 0.0728, 0.0832, 0.0832, 0.27664, 0.27664, 0.27664, 0.31616, 0.31616, .56, .56, .56, 1, .64,
                    0.0728, 0.0728, 0.0728, 0.0832, 0.0832, 0.27664, 0.27664, 0.27664, 0.31616, 0.31616, .56, .56, .56, .64, 1
), 15, 15, byrow = T)

### 7 items per factor
Ptrue7_f <- matrix(c(.7, .7,.7, .7, .8, .8, .8, rep(0, 21), .6, .6, .7, .7, .7, .8, .8, rep(0, 21), .6, .6, .7, .7, .7, .8, .8), ncol = 3)
# correlation matrix
corr7_f <- matrix(c(1, .49, .49, .49, .56, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8,
                    .49, 1, .49, .49, .56, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8,
                    .49, .49, 1, .49, .56, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8,
                    .49, .49, .49, 1, .56, .56, .56, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.7+.7*.3*.5*.7, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8, -.7*.02*.8+.7*.3*.5*.8,
                    .56, .56, .56, .56, 1, .64, .64, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .8*.3*.8, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, 
                    .56, .56, .56, .56, .64, 1, .64, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .8*.3*.8, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, 
                    .56, .56, .56, .56, .64, .64, 1, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .8*.3*.8, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.7+.8*.3*.5*.7, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, -.8*.02*.8+.8*.3*.5*.8, 
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, 1, .49, .49, .49, .56, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, 
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, .49, 1, .49, .49, .56, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, 
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, .49, .49, 1, .49, .56, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, 
                    .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.7, .7*.3*.8, .7*.3*.8, .7*.3*.8, .49, .49, .49, 1, .56, .56, .56, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.7-.7*.3*.02*.7, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, .7*.5*.8-.7*.3*.02*.8, 
                    .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .8*.3*.8, .56, .56, .56, .56, 1, .64, .64, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8,
                    .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .8*.3*.8, .56, .56, .56, .56, .64, 1, .64, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8,
                    .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.7, .8*.3*.8, .8*.3*.8, .8*.3*.8, .56, .56, .56, .56, .64, .64, 1, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.7-.8*.3*.02*.7, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8, .8*.5*.8-.8*.3*.02*.8,
                    0.0637, 0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, 0.27664, 1, .49, .49, .49, .56, .56, .56, 
                    0.0637, 0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, 0.27664, .49, 1, .49, .49, .56, .56, .56,
                    0.0637, 0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, 0.27664, .49, .49, 1, .49, .56, .56, .56,
                    0.0637, 0.0637, 0.0637, 0.0637, 0.0728, 0.0728, 0.0728, 0.24206, 0.24206, 0.24206, 0.24206, 0.27664, 0.27664, 0.27664, .49, .49, .49, 1, .56, .56, .56,
                    0.0728, 0.0728, 0.0728, 0.0728, 0.0832, 0.0832, 0.0832, 0.27664, 0.27664, 0.27664, 0.27664, 0.31616, 0.31616, 0.31616, .56, .56, .56, .56, 1, .64, .64, 
                    0.0728, 0.0728, 0.0728, 0.0728, 0.0832, 0.0832, 0.0832, 0.27664, 0.27664, 0.27664, 0.27664, 0.31616, 0.31616, 0.31616, .56, .56, .56, .56, .64, 1, .64,
                    0.0728, 0.0728, 0.0728, 0.0728, 0.0832, 0.0832, 0.0832, 0.27664, 0.27664, 0.27664, 0.27664, 0.31616, 0.31616, 0.31616, .56, .56, .56, .56, .64, .64, 1
), 21, 21, byrow = T)
